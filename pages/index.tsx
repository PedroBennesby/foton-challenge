import { Box, Heading } from '@chakra-ui/react';
import type { InferGetStaticPropsType, NextPage } from 'next';
import Head from 'next/head';
import React from 'react';
import CurrentlyReadingContainer from '../components/CurrentlyReadingContainer';
import NewBooksContainer from '../components/NewBooksContainer';
import ReviewsOfTheDayContainer from '../components/ReviewsOfTheDayContainer';
import SearchBox from '../components/SearchBar';
import { GetStaticProps } from 'next';

type Book = {
  title: string | null;
  author: string | null;
  description: string | null;
  image: string | null;
};

export const getStaticProps: GetStaticProps = async (context) => {
  const res = await fetch(
    'https://www.googleapis.com/books/v1/volumes?q=the%20name%20of%20the%20wind=lite'
  );
  const books: Book[] = new Array<Book>();
  const bookResponse = await res.json();

  for (const book of bookResponse.items) {
    books.push({
      title: book.volumeInfo.title || null,
      author: book.volumeInfo.authors || null,
      image: book.volumeInfo.imageLinks.thumbnail || null,
      description: book.volumeInfo.description || null,
    });
  }
  console.log(books);

  return {
    props: {
      books,
    },
  };
};

const Home: NextPage = ({
  books,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  console.log(books);
  return (
    <div>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Box bg="#FFF6E5" w="100%" h="100%" p="50px 20px 0 20px">
        <SearchBox />

        <Box mt="30" display="flex" alignItems="center">
          <Heading color="#55565A">Hi,</Heading>
          <Heading ml="2" color="#FE6A78">
            Foton Dev Team üëãüèΩ
          </Heading>
        </Box>
        <NewBooksContainer books={books} />
        <CurrentlyReadingContainer books={books} />
        <ReviewsOfTheDayContainer books={books} />
      </Box>
    </div>
  );
};

export default Home;
